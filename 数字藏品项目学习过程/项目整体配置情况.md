#### 1、虚拟机centos7  配置给到4核16G内存，能带动nacos  spring cloud gateway redis

#### 2、CentOS 7.x 下     docker 的安装

运行以下命令，下载docker-ce的yum源。 

```
sudo wget -O /etc/yum.repos.d/docker-ce.repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo
```

运行以下命令，安装Docker。 

```
sudo yum -y install docker-ce
```

执行以下命令，检查Docker是否安装成功。 

```
sudo docker -v
```

执行以下命令，启动Docker服务，并设置开机自启动。 

```
sudo systemctl start dockersudo systemctl enable docker
```

执行以下命令，查看Docker是否启动。 

```
sudo systemctl status docker
```

运行以下命令，安装setuptools。 

```
sudo pip3 install -U pip setuptools
```

运行以下命令，安装docker-compose。 

```
sudo pip3 install docker-compose
```

运行以下命令，验证docker-compose是否安装成功。 

```
docker-compose --version
```

如果回显返回docker-compose版本信息，表示docker-compose已安装成功。

### 3、基于 docker-compose 部署中间件环境

##### 一键部署：

unzip NFTurbo-20240808.zip

cd NFTurbosh 

ipchange.sh 我的ip

docker-compose up -d

启动容器

##### 分开部署：

配置docker国内源：

```
sudo tee /etc/docker/daemon.json <<EOF{    "registry-mirrors": ["https://dockerhub.icu"]}EOF
sudo systemctl daemon-reloadsudo systemctl restart docker
```

### 4、Mysql为nacos建库

修改 nacos-docker-2.3.0/env/nacos-standlone-mysql.env

主要修改：MYSQL_SERVICE_HOST、MYSQL_SERVICE_DB_NAME、MYSQL_SERVICE_USER、MYSQL_SERVICE_PASSWORD等几个为你自己的数据链接信息：

```
PREFER_HOST_MODE=hostname
MODE=standalone
SPRING_DATASOURCE_PLATFORM=mysql
MYSQL_SERVICE_HOST=rm****.mysql.rds.aliyuncs.com
MYSQL_SERVICE_DB_NAME=nacos_config
MYSQL_SERVICE_PORT=3306
MYSQL_SERVICE_USER=nfturbo
MYSQL_SERVICE_PASSWORD=NFTurbo***
MYSQL_SERVICE_DB_PARAM=characterEncoding=utf8&connectTimeout=1000&socketTimeout=3000&autoReconnect=true&useUnicode=true&useSSL=false&serverTimezone=Asia/Shanghai&allowPublicKeyRetrieval=true                  
```

##### 创建数据库及建表

创建名称为nacos_config的数据库，并且初始化表结构，建表语句在下面

https://github.com/alibaba/nacos/blob/2.3.0/distribution/conf/mysql-schema.sql  （如果你安装的是大于等于2.5.0的建表语句：https://github.com/alibaba/nacos/blob/2.5.0/distribution/conf/mysql-schema.sql

##### 启动nacos

```
docker-compose up  #启动所有容器
docker-compose up -d  #后台启动并运行
docker-compose stop  #停止容器
docker-compose start  #启动容器
docker-compose down #停止并销毁容器
```

如果报错查看nacos日志， docker logs -f nacos

##### 注意用idea连SSH到虚拟机192.168.89.128

##### 远程配置数据库，在idea里面写数据表

##### 然后ip访问nacos：http://192.168.89.128:8848/nacos/index.html#，账户密码都是nacos，ip是192.168.89.128，打开端口8848

http://192.168.89.128:8848/nacos/index.html#/configurationManagement?dataId=&group=&appName=&namespace=&pageSize=&pageNo=&namespaceShowName=public
![](https://github.com/WeiGuang1214/Study-Notes/blob/master/%E6%95%B0%E5%AD%97%E8%97%8F%E5%93%81%E9%A1%B9%E7%9B%AE%E5%AD%A6%E4%B9%A0%E8%BF%87%E7%A8%8B/%E5%9B%BE%E7%89%87/IDEA%E7%9A%84ssh.png)
